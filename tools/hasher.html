<div class="tool unfocused col2" id="hasher" data-tag="hash md5 sha des">
	<div class="preview"><h1>Hasher</h1></div>
	<div class="controls smaller">
		<label for="hasherInput">Input</label>
		<input type="text" class="hasherInput" id="hasherInput" autofocus tabindex="21" />

		<div class="checksums subsection"></div>
		
		<div class="hashes subsection"></div>
		
		<label for="hasherKeyInput">Encryption key</label>
		<input type="text" class="hasherKeyInput" id="hasherKeyInput" autofocus tabindex="21" />
		<div class="ciphers subsection"></div>
	</div>

	<script src="./node_modules/crypto-js/crypto-js.js?dontcachemepls"></script>
	<script src="./node_modules/js-crc/build/crc.min.js?dontcachemepls"></script>

	<script>
		class THasher extends Tool {
			constructor(id) {
				super(id);

				this.input = this.$('.hasherInput')[0];
				this.keyInput = this.$('.hasherKeyInput')[0];

				this.keyInput.oninput = this.keyInput.onchange = this.input.oninput = this.input.onchange = () => this.hash();
			}

			hash() {
				let checksums = this.$(".checksums")[0];
				let hashes = this.$(".hashes")[0];
				let ciphers = this.$(".ciphers")[0];

				this.removeChildren(checksums);
				this.removeChildren(hashes);
				this.removeChildren(ciphers);

				checksums.appendChild(this.Component('sectionLabel', "Checksums"));
				checksums.appendChild(this.Component('hash', "CRC16", crc16(this.input.value)));
				checksums.appendChild(this.Component('hash', "CRC32", crc32(this.input.value)));
				
				hashes.appendChild(this.Component('sectionLabel', "Hashes"));
				hashes.appendChild(this.Component('hash', "MD5", '' + CryptoJS.MD5(this.input.value)));
				hashes.appendChild(this.Component('hash', "SHA1", '' + CryptoJS.SHA1(this.input.value)));
				hashes.appendChild(this.Component('hash', "SHA3", '' + CryptoJS.SHA3(this.input.value)));
				hashes.appendChild(this.Component('hash', "SHA256", '' + CryptoJS.SHA256(this.input.value)));
				
				ciphers.appendChild(this.Component('sectionLabel', "Ciphers"));
				let aes = CryptoJS.AES.encrypt(this.input.value, this.keyInput.value, {keySize: 128});
				let des = CryptoJS.DES.encrypt(this.input.value, this.keyInput.value, {keySize: 128});
				// console.log(aes);
				// console.log(aes.key.toString());
				// console.log(aes.iv.toString());
				// console.log(aes.ciphertext.toString());
				// console.log(aes.key);
				// console.log(aes.iv);
				// console.log(aes.ciphertext);
				ciphers.appendChild(this.Component('hash', "AES", aes.ciphertext.toString()));
				ciphers.appendChild(this.Component('hash', "DES", des.ciphertext.toString()));
			};
		}

		tools.add(new THasher("hasher"));
	</script>

	<div class="components">
		<h1 class="sectionLabel" data-arg="0">Hashes</h1>

		<div class="hash kvpair">
			<span class="label" data-arg="0"></span>
			<span class="value" data-arg="1"></span>
		</div>
	</div>
</div>