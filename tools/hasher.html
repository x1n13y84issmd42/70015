<tool _id="hasher" data-tag="hash md5 sha des" name="Hashes &amp; ciphers">
	<input type="text" _id="input" autofocus tabindex="21" label="Input"/>

	<div class="checksums subsection"></div>
	<div class="hashes subsection"></div>
	
	<input type="text" class="hasherKeyInput" _id="key" autofocus tabindex="21" label="Encryption key" />

	<div class="ciphers subsection"></div>

	<div class="components">
		<h1 class="sectionLabel" data-arg="0"></h1>
	
		<div class="hash kvpair">
			<span class="label" data-arg="0"></span>
			<span class="value copy" data-arg="1"></span>
		</div>
	</div>
</tool>

<script src="./node_modules/crypto-js/crypto-js.js?dontcachemepls"></script>
<script src="./node_modules/js-crc/build/crc.min.js?dontcachemepls"></script>

<script>
	(() => {
		class THasher extends Tool {
			constructor(id) {
				super(id);

				this.input = this.$$('input');
				this.keyInput = this.$$('key');

				this.keyInput.oninput = this.input.oninput = () => this.hash();
			}

			hash() {
				let checksums = this.$(".checksums")[0];
				let hashes = this.$(".hashes")[0];
				let ciphers = this.$(".ciphers")[0];

				this.removeChildren(checksums);
				this.removeChildren(hashes);
				this.removeChildren(ciphers);

				checksums.appendChild(this.Component('sectionLabel', "Checksums"));
				checksums.appendChild(this.Component('hash', "CRC16", crc16(this.input.value)));
				checksums.appendChild(this.Component('hash', "CRC32", crc32(this.input.value)));
				
				hashes.appendChild(this.Component('sectionLabel', "Hashes"));
				hashes.appendChild(this.Component('hash', "MD5", '' + CryptoJS.MD5(this.input.value)));
				hashes.appendChild(this.Component('hash', "SHA1", '' + CryptoJS.SHA1(this.input.value)));
				hashes.appendChild(this.Component('hash', "SHA3", '' + CryptoJS.SHA3(this.input.value)));
				hashes.appendChild(this.Component('hash', "SHA256", '' + CryptoJS.SHA256(this.input.value)));
				
				ciphers.appendChild(this.Component('sectionLabel', "Ciphers"));
				let aes = CryptoJS.AES.encrypt(this.input.value, this.keyInput.value, {keySize: 128});
				let des = CryptoJS.DES.encrypt(this.input.value, this.keyInput.value, {keySize: 128});
				// console.log(aes);
				// console.log(aes.key.toString());
				// console.log(aes.iv.toString());
				// console.log(aes.ciphertext.toString());
				// console.log(aes.key);
				// console.log(aes.iv);
				// console.log(aes.ciphertext);
				ciphers.appendChild(this.Component('hash', "AES", aes.ciphertext.toString()));
				ciphers.appendChild(this.Component('hash', "DES", des.ciphertext.toString()));
			};

			import(data) {
				if (data.input) {
					this.T(this.$$('input'), data.input);
					this.hash();
				}
			}
		}

		let comp = Component.New('hasher');
		window.tools.appendChild(comp);
		bench.add(new THasher(comp));
	})()
</script>
